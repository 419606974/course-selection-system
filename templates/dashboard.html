<!DOCTYPE html>
<html lang="zh">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>后台管理系统</title>
    <link rel="shortcut icon" type="image/x-icon" href="static/favicon.ico">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="stylesheet" type="text/css" href="static/css/materialdesignicons.min.css">
    <link rel="stylesheet" type="text/css" href="static/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="static/js/bootstrap-multitabs/multitabs.min.css">
    <link rel="stylesheet" type="text/css" href="static/css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="static/css/style.min.css">
</head>

<body>
<div class="lyear-layout-web">
    <div class="lyear-layout-container">
        <!--左侧导航-->
        <aside class="lyear-layout-sidebar">
            <!-- logo -->
            <div id="logo" class="sidebar-header">
                <a href="/#"><img src="static/images/logo-sidebar.png" title="LightYear" alt="LightYear"/></a>
            </div>
            <div class="lyear-layout-sidebar-info lyear-scroll">
                <nav class="sidebar-main">
                    <ul class="nav-drawer">
<!--                        <li permission-id="1" class="nav-item active">-->
<!--                            <a class="multitabs" href="lyear_main.html">-->
<!--                                <i class="mdi mdi-desktop-mac-dashboard"></i>-->
<!--                                <span>数据大屏</span>-->
<!--                            </a>-->
<!--                        </li>-->
                        <li permission-id="2" class="nav-item nav-item">
                            <a href="/welcome" class="multitabs">
                                <i class="mdi mdi-home"></i>
                                <span>首页</span>
                            </a>
                        </li>
                        <li permission-id="4" class="nav-item nav-item">
                            <a href="/teacher" class="multitabs">
                                <i class="mdi mdi-teach"></i>
                                <span>教师管理</span>
                            </a>
                        </li>
                        <li permission-id="4" class="nav-item nav-item">
                            <a href="/user" class="multitabs">
                                <i class="mdi mdi-nature-people"></i>
                                <span>学生管理</span>
                            </a>
                        </li>
                        <li permission-id="4" class="nav-item nav-item">
                            <a href="/course" class="multitabs">
                                <i class="mdi mdi-alarm"></i>
                                <span>课程管理</span>
                            </a>
                        </li>
                        <li class="nav-item nav-item-has-subnav">
                            <a href="javascript:void(0)"><i class="mdi mdi-silo"></i> <span>成绩管理</span></a>
                            <ul class="nav nav-subnav show">
<!--                                <li permission-id="4"><a class="multitabs" href="/course">课程管理</a></li>-->
                                <li permission-id="4"><a class="multitabs" href="/achievement">成绩录入</a></li>
                                <li permission-id="4"><a class="multitabs" href="/gradelevel">成绩分级</a></li>
                                <li permission-id="4"><a class="multitabs" href="/average">平均成绩</a></li>
                                <li permission-id="4"><a class="multitabs" href="/progress">年度进步</a></li>
                                <li permission-id="5"><a class="multitabs" href="/course_select">选课</a></li>
                                <li permission-id="5"><a class="multitabs" href="/my_course">我的课程</a></li>
                                <li permission-id="5"><a class="multitabs" href="/score">成绩查询</a></li>
                            </ul>
                        </li>
<!--                        <li permission-id="6" class="nav-item nav-item">-->
<!--                            <a class="multitabs" href="/notice">-->
<!--                                <i class="mdi mdi-message-text"></i>-->
<!--                                <span>公告管理</span>-->
<!--                            </a>-->
<!--                        </li>-->
                        <li permission-id="7" class="nav-item nav-item">
                            <a class="multitabs" href="/audit">
                                <i class="mdi mdi-notification-clear-all"></i>
                                <span>审计日志</span>
                            </a>
                        </li>
<!--                        <li permission-id="8" class="nav-item nav-item-has-subnav">-->
<!--                            <a href="javascript:void(0)"><i class="mdi mdi-tools"></i> <span>系统工具</span></a>-->
<!--                            <ul class="nav nav-subnav">-->
<!--                                <li permission-id="8"><a class="multitabs" href="/role">角色管理</a></li>-->
<!--                                <li permission-id="9"><a class="multitabs" href="/permissions">权限设置</a></li>-->
<!--                                <li permission-id="10"><a class="multitabs" href="/user">用户管理</a></li>-->

<!--                            </ul>-->
<!--                        </li>-->
                    </ul>
                </nav>


            </div>

        </aside>
        <!--End 左侧导航-->

        <!--头部信息-->
        <header class="lyear-layout-header">

            <nav class="navbar">

                <div class="navbar-left">
                    <div class="lyear-aside-toggler">
                        <span class="lyear-toggler-bar"></span>
                        <span class="lyear-toggler-bar"></span>
                        <span class="lyear-toggler-bar"></span>
                    </div>
                </div>

                <ul class="navbar-right d-flex align-items-center">
<!--                    <li class="dropdown dropdown-notice">-->
<!--								<span data-toggle="dropdown" class="icon-item">-->
<!--									<i class="mdi mdi-bell-outline"></i>-->
<!--									<span class="badge badge-danger">{{notice_infos.total}}</span>-->
<!--								</span>-->
<!--                        <div class="dropdown-menu dropdown-menu-right">-->
<!--                            <div class="lyear-notifications">-->

<!--                                <div class="lyear-notifications-title clearfix" data-stopPropagation="true"><a-->
<!--                                        href="/notice" class="float-right js-create-tab" id="view-all-notices" data-title="公告管理">查看全部</a>你有-->
<!--                                    {{notice_infos.total}} 条未读消息-->
<!--                                </div>-->
<!--                                <div class="lyear-notifications-info lyear-scroll">-->
<!--                                    {% for item in notice_infos.infos %}-->
<!--                                    <a href="#!" class="dropdown-item"-->
<!--                                       title="{{ item.content }}">{{ item.title }}</a>-->
<!--                                    {% endfor %}-->
<!--                                </div>-->

<!--                            </div>-->
<!--                        </div>-->
<!--                    </li>-->
                    <!--切换主题配色-->
                    <li class="dropdown dropdown-skin">
                        <span data-toggle="dropdown" class="icon-item"><i class="mdi mdi-palette"></i></span>
                        <ul class="dropdown-menu dropdown-menu-right" data-stopPropagation="true">
                            <li class="drop-title">
                                <p>LOGO</p>
                            </li>
                            <li class="drop-skin-li clearfix">
										<span class="inverse">
											<input type="radio" name="logo_bg" value="default" id="logo_bg_1" checked>
											<label for="logo_bg_1"></label>
										</span>
                                <span>
											<input type="radio" name="logo_bg" value="color_2" id="logo_bg_2">
											<label for="logo_bg_2"></label>
										</span>
                                <span>
											<input type="radio" name="logo_bg" value="color_3" id="logo_bg_3">
											<label for="logo_bg_3"></label>
										</span>
                                <span>
											<input type="radio" name="logo_bg" value="color_4" id="logo_bg_4">
											<label for="logo_bg_4"></label>
										</span>
                                <span>
											<input type="radio" name="logo_bg" value="color_5" id="logo_bg_5">
											<label for="logo_bg_5"></label>
										</span>
                                <span>
											<input type="radio" name="logo_bg" value="color_6" id="logo_bg_6">
											<label for="logo_bg_6"></label>
										</span>
                                <span>
											<input type="radio" name="logo_bg" value="color_7" id="logo_bg_7">
											<label for="logo_bg_7"></label>
										</span>
                                <span>
											<input type="radio" name="logo_bg" value="color_8" id="logo_bg_8">
											<label for="logo_bg_8"></label>
										</span>
                            </li>
                            <li class="drop-title">
                                <p>头部</p>
                            </li>
                            <li class="drop-skin-li clearfix">
										<span class="inverse">
											<input type="radio" name="header_bg" value="default" id="header_bg_1"
                                                   checked>
											<label for="header_bg_1"></label>
										</span>
                                <span>
											<input type="radio" name="header_bg" value="color_2" id="header_bg_2">
											<label for="header_bg_2"></label>
										</span>
                                <span>
											<input type="radio" name="header_bg" value="color_3" id="header_bg_3">
											<label for="header_bg_3"></label>
										</span>
                                <span>
											<input type="radio" name="header_bg" value="color_4" id="header_bg_4">
											<label for="header_bg_4"></label>
										</span>
                                <span>
											<input type="radio" name="header_bg" value="color_5" id="header_bg_5">
											<label for="header_bg_5"></label>
										</span>
                                <span>
											<input type="radio" name="header_bg" value="color_6" id="header_bg_6">
											<label for="header_bg_6"></label>
										</span>
                                <span>
											<input type="radio" name="header_bg" value="color_7" id="header_bg_7">
											<label for="header_bg_7"></label>
										</span>
                                <span>
											<input type="radio" name="header_bg" value="color_8" id="header_bg_8">
											<label for="header_bg_8"></label>
										</span>
                            </li>
                            <li class="drop-title">
                                <p>侧边栏</p>
                            </li>
                            <li class="drop-skin-li clearfix">
										<span class="inverse">
											<input type="radio" name="sidebar_bg" value="default" id="sidebar_bg_1"
                                                   checked>
											<label for="sidebar_bg_1"></label>
										</span>
                                <span>
											<input type="radio" name="sidebar_bg" value="color_2" id="sidebar_bg_2">
											<label for="sidebar_bg_2"></label>
										</span>
                                <span>
											<input type="radio" name="sidebar_bg" value="color_3" id="sidebar_bg_3">
											<label for="sidebar_bg_3"></label>
										</span>
                                <span>
											<input type="radio" name="sidebar_bg" value="color_4" id="sidebar_bg_4">
											<label for="sidebar_bg_4"></label>
										</span>
                                <span>
											<input type="radio" name="sidebar_bg" value="color_5" id="sidebar_bg_5">
											<label for="sidebar_bg_5"></label>
										</span>
                                <span>
											<input type="radio" name="sidebar_bg" value="color_6" id="sidebar_bg_6">
											<label for="sidebar_bg_6"></label>
										</span>
                                <span>
											<input type="radio" name="sidebar_bg" value="color_7" id="sidebar_bg_7">
											<label for="sidebar_bg_7"></label>
										</span>
                                <span>
											<input type="radio" name="sidebar_bg" value="color_8" id="sidebar_bg_8">
											<label for="sidebar_bg_8"></label>
										</span>
                            </li>
                        </ul>
                    </li>
                    <!--切换主题配色-->
                    <li class="dropdown dropdown-profile">
                        <a href="javascript:void(0)" data-toggle="dropdown" class="dropdown-toggle">

                            <span id="welcomeInfo"></span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-right">
<!--                            <li>-->
<!--                                <a class="multitabs dropdown-item" class="js-create-tab" data-title="个人信息"-->
<!--                                   href="/user_center" id="user-center"><i class="mdi mdi-account"></i> 个人信息</a>-->
<!--                            </li>-->
                            <li>
                                <a class="multitabs dropdown-item"
                                   href="/password" id="change-password"><i class="mdi mdi-lock-outline"></i> 修改密码</a>
                            </li>

                            <li class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item" href="/logout" onclick="handleLogout(event); return false;"><i
                                        class="mdi mdi-logout-variant"></i> 退出登录</a>
                            </li>
                        </ul>
                    </li>
                </ul>

            </nav>

        </header>
        <!--End 头部信息-->

        <!--iframe页面主要内容-->
        <main class="lyear-layout-content">
            <div id="iframe-content">

            </div>
        </main>
        <!--End 页面主要内容-->
    </div>
</div>

<script type="text/javascript" src="static/js/jquery.min.js"></script>
<script type="text/javascript" src="static/js/popper.min.js"></script>
<script type="text/javascript" src="static/js/bootstrap.min.js"></script>
<script type="text/javascript" src="static/js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="static/js/bootstrap-multitabs/multitabs.min.js"></script>
<script type="text/javascript" src="static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="static/js/Chart.min.js"></script>
<script type="text/javascript" src="static/js/index.min.js"></script>
<script type="text/javascript" src="static/js/main.min.js"></script>
<script type="text/javascript" src="static/js/myutils.js"></script>
<script type="text/javascript">
    // 使用JavaScript来获取localStorage中的权限ID并显示相应的视图
    document.addEventListener('DOMContentLoaded', function () {
        const username = localStorage.getItem('username');
        document.getElementById('welcomeInfo').textContent = '欢迎您，' + username;
        accessControl();
    });
    $(document).ready(function () {
        // 当点击“查看全部”时，改变 iframe 的 src
        $('#view-all-notices').on('click', function (event) {
            event.preventDefault(); // 阻止默认的链接行为
            var iframe = $('#multitabs_main_0');
            iframe.attr('src', '/notice'); // 设置新的 src
        });

        $('#user-center').on('click', function (event) {
            event.preventDefault();
            var iframe = $('#multitabs_main_0');
            iframe.attr('src', '/user_center');
        });

        $('#change-password').on('click', function (event) {
            event.preventDefault();
            var iframe = $('#multitabs_main_0');
            iframe.attr('src', '/password');
        });
    });

    function handleLogout(event) {
        event.preventDefault(); // 阻止默认行为，如页面跳转
        sendPostRequest('/logout', {}, function (data) {
            if (data.success) {
                // 登出成功后重定向到首页或其他页面
                window.location.href = '/login';
                localStorage.removeItem('role')
                localStorage.removeItem('permissionIds')
                notice(data.message, 'success');
            } else {
                // 显示错误消息
                console.error(data.message);
                notice(data.message, 'danger');
            }
        }, function (error) {
            notice(error.statusMessage, 'danger');
        });
    }
    $(document).ready(function() {
        // 触发点击事件展开“成绩管理”菜单
        $('.nav-item-has-subnav > a').each(function() {
            if ($(this).text().includes("成绩管理")) {
                $(this).trigger('click');
            }
        });
    });
</script>
</body>
</html>
